'''
Stanley Bak
F-16 GCAS in Python
cl function
用于根据角度 alpha（俯仰角）和侧滑角（beta）来计算升力系数（cl）。
'''

import numpy as np

from aerobench.util import fix, sign

def cl(alpha, beta):
    'cl function'

    a = np.array([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], \
    [-.001, -.004, -.008, -.012, -.016, -.022, -.022, -.021, -.015, -.008, -.013, -.015], \
    [-.003, -.009, -.017, -.024, -.030, -.041, -.045, -.040, -.016, -.002, -.010, -.019], \
    [-.001, -.010, -.020, -.030, -.039, -.054, -.057, -.054, -.023, -.006, -.014, -.027], \
    [.000, -.010, -.022, -.034, -.047, -.060, -.069, -.067, -.033, -.036, -.035, -.035], \
    [.007, -.010, -.023, -.034, -.049, -.063, -.081, -.079, -.060, -.058, -.062, -.059], \
    [.009, -.011, -.023, -.037, -.050, -.068, -.089, -.088, -.091, -.076, -.077, -.076]], dtype=float).T

    s = .2 * alpha
    k = fix(s)

    if k <= -2:
        k = -1

    if k >= 9:
        k = 8

    da = s - k
    l = k + fix(1.1 * sign(da))
    s = .2 * abs(beta)
    m = fix(s)
    if m == 0:
        m = 1

    if m >= 6:
        m = 5

    db = s - m
    n = m + fix(1.1 * sign(db))
    l = l + 3
    k = k + 3
    m = m + 1
    n = n + 1
    t = a[k-1, m-1]
    u = a[k-1, n-1]
    v = t + abs(da) * (a[l-1, m-1] - t)
    w = u + abs(da) * (a[l-1, n-1] - u)
    dum = v + (w - v) * abs(db)

    return dum * sign(beta)

# 这个函数cl用于根据角度of attack（攻角，alpha）和侧滑角（beta）来计算升力系数（cl）。
#
# 参数
# alpha: 攻角，单位一般为度或弧度。
# beta: 侧滑角，单位一般为度或弧度。
# 局部变量
# a: 一个二维数组，包含了攻角和侧滑角对应的升力系数数据。
# s, k, da, l, m, db, n: 用于插值计算的临时变量。
# t, u, v, w, dum: 用于存储插值结果的变量。
# 过程
# 计算索引和差值: 用于查找a数组中相应的升力系数，并进行线性插值。
# 线性插值: 使用查找到的索引和差值进行线性插值，以获得在给定攻角和侧滑角下的升力系数。
# 返回结果: 返回计算得到的升力系数。
# 输出
# dum: 插值计算得到的升力系数，乘以beta的符号（因为侧滑角的方向会影响升力系数）。
# 该函数使用了一个预定义的二维数组a，其中包含了不同攻角和侧滑角下的升力系数数据。这些数据通常是通过风洞实验或数值模拟获得的。函数通过线性插值来估算在给定攻角和侧滑角下的升力系数。注意，这是一个非常特定的模型，通常用于特定类型的飞机。